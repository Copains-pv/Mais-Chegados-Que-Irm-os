<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Copains - Meus Favoritos</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,700;1,700&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <style>
      :root {
        --primary-color: #ff6f61;
        --secondary-color: #333;
        --bg-color: #f4f4f4;
        --card-bg: #fff;
      }

      body {
        font-family: "Montserrat", sans-serif;
        background-color: var(--bg-color);
        color: var(--secondary-color);
      }

      /* Navbar simplificada para manter consistência */
      .navbar-custom {
        background-color: #fff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        padding: 1rem 0;
      }
      .navbar-brand {
        font-weight: 700;
        color: var(--primary-color) !important;
      }
      .nav-link {
        color: var(--secondary-color) !important;
        font-weight: 500;
      }
      .nav-link:hover {
        color: var(--primary-color) !important;
      }

      /* Área de Conteúdo */
      .favorites-section {
        padding: 3rem 0;
        min-height: 80vh;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }

      .section-title {
        font-weight: 700;
        border-left: 5px solid var(--primary-color);
        padding-left: 15px;
      }

      /* Botão de Limpar */
      .btn-clear {
        background-color: transparent;
        border: 1px solid #dc3545;
        color: #dc3545;
        transition: all 0.3s;
      }
      .btn-clear:hover {
        background-color: #dc3545;
        color: #fff;
      }

      /* Card do Favorito */
      .product-card {
        background-color: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
        height: 100%; /* Para alinhar alturas no grid */
        display: flex;
        flex-direction: column;
        position: relative;
      }

      .product-card:hover {
        transform: translateY(-5px);
      }

      .product-card img {
        width: 100%;
        height: 250px;
        object-fit: cover;
      }

      .product-info {
        padding: 1.5rem;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
      }

      .product-name {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .product-price {
        color: var(--primary-color);
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: auto; /* Empurra conteúdo para baixo se houvesse algo */
      }

      /* Ícone de Excluir (Coração) */
      .favorite-icon {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 50%;
        width: 35px;
        height: 35px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 10;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .favorite-icon i {
        color: var(--primary-color); /* Sempre vermelho aqui */
        font-size: 1.1rem;
      }

      .favorite-icon:hover {
        background-color: #ffe6e6;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-custom sticky-top">
      <div class="container">
        <a class="navbar-brand" href="TESTE.HTML">Copains</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse justify-content-end"
          id="navbarNav"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="catalogo_de_produtos.html">Voltar à Loja</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container favorites-section">
      <div class="section-header">
        <h2 class="section-title">Meus Favoritos</h2>
        <button id="clear-favorites-btn" class="btn btn-clear btn-sm">
          <i class="fas fa-trash-alt me-2"></i>Limpar Favoritos
        </button>
      </div>

      <div
        id="favorites-list"
        class="row g-4"
        role="list"
        aria-live="polite"
      ></div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const favoritesContainer = document.getElementById("favorites-list");
        const clearFavoritesBtn = document.getElementById(
          "clear-favorites-btn"
        );

        // Função para desenhar a lista na tela
        function renderFavorites() {
          const favorites = JSON.parse(localStorage.getItem("favorites")) || [];

          // Limpa HTML atual
          favoritesContainer.innerHTML = "";

          // Se não houver favoritos
          if (favorites.length === 0) {
            favoritesContainer.innerHTML = `
                <div class="col-12 text-center mt-5">
                    <h4 class="text-muted">Você ainda não tem favoritos.</h4>
                    <a href="TESTE.HTML" class="btn btn-outline-dark mt-3">Ir para a Loja</a>
                </div>`;
            // Esconde botão de limpar tudo se estiver vazio
            if (clearFavoritesBtn) clearFavoritesBtn.style.display = "none";
            return;
          }

          // Se houver favoritos, mostra botão limpar e renderiza cards
          if (clearFavoritesBtn) clearFavoritesBtn.style.display = "block";

          favorites.forEach((product) => {
            // Cria a coluna do Bootstrap
            const col = document.createElement("div");
            col.classList.add("col-12", "col-sm-6", "col-md-4", "col-lg-3");

            // Cria o card
            const card = document.createElement("div");
            card.classList.add("product-card");
            card.setAttribute("data-id", product.id);

            // Conteúdo do card (SEM botão de adicionar ao carrinho)
            card.innerHTML = `
              <div class="favorite-icon" title="Remover dos favoritos">
                <i class="fas fa-heart"></i>
              </div>
              <a href="${product.link || "#"}">
                <img src="${product.image}" alt="${
              product.name
            }" onerror="this.src='https://placehold.co/300x300?text=Imagem+Indisponível'">
              </a>
              <div class="product-info">
                <h3 class="product-name">${product.name}</h3>
                <p class="product-price">${product.price}</p>
                <div class="mt-3 d-flex gap-2">
                  ${
                    product.link && product.link !== "#"
                      ? `<a class="btn btn-primary btn-sm buy-now-btn" href="${product.link}" target="_blank" rel="noopener noreferrer">Comprar Agora</a>`
                      : ``
                  }
                  <button class="btn btn-outline-secondary btn-sm btn-remove-fav" aria-label="Remover ${
                    product.name
                  }">Remover</button>
                </div>
              </div>
            `;

            // Lógica de clicar no coração para excluir ESTE item
            const heartBtn = card.querySelector(".favorite-icon");
            heartBtn.addEventListener("click", () => {
              removeFavorite(product.id);
            });

            // Botão de remover (alternativa ao ícone)
            const removeBtn = card.querySelector(".btn-remove-fav");
            if (removeBtn) {
              removeBtn.addEventListener("click", () =>
                removeFavorite(product.id)
              );
            }

            col.appendChild(card);
            favoritesContainer.appendChild(col);
          });
        }

        // Função para remover UM item
        function removeFavorite(id) {
          let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
          favorites = favorites.filter((p) => p.id !== id);
          localStorage.setItem("favorites", JSON.stringify(favorites));
          renderFavorites(); // Atualiza a tela
        }

        // Função para remover TODOS os itens
        if (clearFavoritesBtn) {
          clearFavoritesBtn.addEventListener("click", (e) => {
            e.preventDefault();
            if (
              confirm(
                "Tem certeza que deseja remover todos os seus produtos favoritos?"
              )
            ) {
              localStorage.removeItem("favorites");
              renderFavorites();
            }
          });
        }

        // Executa ao abrir a página
        renderFavorites();
      });
    </script>
  </body>
</html>
